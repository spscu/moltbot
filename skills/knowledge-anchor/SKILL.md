---
name: knowledge-anchor
description: 知识沉淀工具 — 提炼当前会话中的有价值信息并持久化到本地知识库。触发词：「沉淀知识」「总结经验」「总结教训」「记录教训」「保存规则」「经验沉淀」「知识总结」。当用户说出以上任意短语（即使只有这四个字，无需额外说明），立即执行本技能。也适用于会话结束前的知识归档，或犯错后的经验复盘。
---

# Knowledge Anchor（知识锚点）

将当前会话中的有价值信息提炼并写入本地知识库 `D:\DevSource\.knowledge-base\`。

## 工作流程

### 1. 判断知识类型

根据对话内容判断属于哪个分类：

| 分类 | 目录 | 适用场景 |
|------|------|---------|
| `insight` | `insights/` | 核心洞察、技巧、最佳实践 |
| `anti-pattern` | `anti-patterns/` | 犯错记录、避坑指南、失败复盘 |
| `rule` | `rules/` | 可复用的通用规则、约定、标准 |

### 2. 提炼内容

从当前会话中提取：

- **核心结论**：一句话总结（必须具体可操作，禁止空泛表述）
- **关键细节**：技术要点、参数、命令等
- **错误现场**（anti-pattern 时）：错误原因 + 正确做法
- **可执行规则**：提炼为 bullet list，每条规则可直接在未来任务中应用

### 3. 写入文件

参考 `{baseDir}/references/knowledge-template.md` 中的模板格式。

文件命名：`YYYY-MM-DD_简短英文描述.md`
- 示例：`2026-02-10_fastapi_async_pitfall.md`

写入路径：`D:\DevSource\.knowledge-base\<分类目录>\<文件名>`

### 4. 更新索引

**每次写入新条目后，必须更新** `D:\DevSource\.knowledge-base\index.md`：

在对应分类下追加一行：
```
- [条目标题](分类目录/文件名.md) [标签1, 标签2]
```

如果分类标题不存在，新建该分类标题。

### 5. 确认

完成后向用户确认：
- 已写入的文件路径
- 提炼的核心结论摘要
- 已更新索引

## 注意事项

- 每条知识必须**具体可操作**，避免记录"学到了很多"这种空泛内容
- 标签使用中文，便于后续检索（如：Python、电力造价、Git）
- 一次会话可以沉淀多条知识，分别写入不同文件
- `rules/` 中的文件可以被多次追加更新（同一主题的规则合并到一个文件中）
